suite: dev mode
templates:
  - celery/deployment.yaml
  - engine/deployment.yaml
release:
  name: oncall
tests:
  - it: doesn't add a volume and volume mount when dev_mode is disabled
    set:
      dev_mode: false
    asserts:
      - notExists:
          path: spec.template.spec.containers[0].volumeMounts
      - notExists:
          path: spec.template.spec.initContainers[0].volumeMounts
      - notExists:
          path: spec.template.spec.volumes
  - it: does add a volume and volume mount when dev_mode is enabled
    set:
      dev_mode: true
    asserts:
      - matchSnapshot:
          path: spec.template.spec.containers[0].volumeMounts
      - matchSnapshot:
          path: spec.template.spec.initContainers[0].volumeMounts
      - matchSnapshot:
          path: spec.template.spec.volumes
